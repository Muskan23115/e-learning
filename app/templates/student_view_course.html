<!-- This uses variables from your Python code -->
<video controls width="100%">
    
    <!-- Use the video_url directly, prepended with a '/' to make it a root-relative path -->
    <source src="/{{ course.video_url }}" type="video/mp4">

    <!-- This 'if' block prevents an error if a video has no subtitles -->
    {% if subtitle_file %}
    <track
        kind="subtitles"
        label="{{ lang_name }}"
        src="{{ url_for('static', filename='subtitles/' + subtitle_file) }}"
        srclang="{{ lang_code }}"
        default>
    {% endif %}
  
    Your browser does not support the video tag.
</video>

<!-- The dropdown and script can remain the same -->
<select id="captionSelect" style="margin-top: 15px; padding: 8px;">
    <!-- Use the dynamic language name here -->
    <option value="0">{{ lang_name }}</option>
    <option value="none">No Captions</option>
</select>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const captionSelect = document.getElementById('captionSelect');
        const video = document.querySelector('video');

        if (captionSelect && video) {
            captionSelect.addEventListener('change', function() {
                const tracks = video.textTracks;
                
                for (let i = 0; i < tracks.length; i++) {
                    tracks[i].mode = 'disabled';
                }

                if (this.value !== 'none') {
                    const trackIndex = parseInt(this.value, 10);
                    if (tracks[trackIndex]) {
                        tracks[trackIndex].mode = 'showing';
                    }
                }
            });
        }
    });
</script>
